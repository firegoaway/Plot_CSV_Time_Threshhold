# PCTT - Plot CSV Time Threshold

> Язык: **Python**

> Интерфейс: **Tkinter**

## Особенности и описание работы утилиты
Утилита расчитывает **честное** значение **tпор** тремя разными способами, отображает на графике значения параметра, воздействующего на пожарный извещатель во всех точках области **F** и определяет **dэфф**. Работает как самостоятельно, так и в связке с утилитой [**Zmejka**](https://github.com/firegoaway/Zmejka)

### Метод
1. Пользователь указывает путь к файлу сценария FDS (.fds), вводит запрашиваемые данные, выбирает параметр, воздействующий на пожарный извещатель;
2. В каждой точке расчётной области, на высоте размещения пожарных извещателей, добавляется регистратор (измеритель) этого параметра с определённым паттерном в названии *(DEVC_XnYm_MESH_N)*, указывается пороговое значение, присваиваемое каждому регистратору (измерителю). Пороговое значение определяется строго по [Методике](https://ivo.garant.ru/#/document/406577165/paragraph/1532/doclist/6480/1/0/0/методика%201140:0);
3. Далее пользователь нажимает **"Start"** и ожидает окончания моделирования пожара;
4. FDS расчитывает значение параметра в каждой точке расчётной области **F**. Количество точек в области **F** зависит от размера ячейки;
5. После этого пользователь запускает утилиту **PCTT**, вновь указывает **Hпом** (высоту помещения с очагом пожара), **Cs** (размер ячейки) и путь к результатам расчёта **"_devc.csv"**;
6. Утилита очищает таблицу от лишних *&DEVC*, преобразует научную нотацию записей в обыкновенный математический вид, далее ищет строку, в которой количество ячеек, значение в каждой из которых превышает (в случае с параметром *VISIBILITY* не превышает) пороговое, превышает количество точек **Cc**, в области **F**, необходимое для получения такой площади области **F**, при которой значение эффективного диаметра **dэфф** будет больше или равно нормативному расстоянию между пожарными извещателями. При этом нормативное расстояние между извещателями определяется по формуле ![L_latex](https://raw.githubusercontent.com/firegoaway/Plot_CSV_Time_Threshhold/main/.gitpics/L_latex.jpg)
7. Таким образом, программа расчитывает **tпор** строго по [пунктам 1 и 2 приложения 11 Методики 1140](https://ivo.garant.ru/#/document/406577165/paragraph/1532/doclist/6480/1/0/0/методика%201140:0).

### Методология
Поскольку Fenix+ 3 тщательно скрывает природу происхождения значения ***tпор*** в отчёте и методологию его вычисления, [**Ниса**](https://t.me/nisadypova) добавила в программу функцию вычисления не только ***tпор***, но и ***F (dэфф)*** так, чтобы строго соблюдались [**пункты 1 и 2 приложения 11 Методики 1140**](https://ivo.garant.ru/#/document/406577165/paragraph/1532/doclist/6480/1/0/0/%D0%BC%D0%B5%D1%82%D0%BE%D0%B4%D0%B8%D0%BA%D0%B0%201140:0).

В каждую точку (ячейку) расчётной области, на высоте расположения пожарных извещателей, добавляется измеритель (регистратор) параметра, воздействующего на пожарный извещатель.

Пользователь может выбрать, какой параметр будет воздействовать на извещатель в процессе моделирования. На выбор доступны 3 параметра:
- Видимость (**VISIBILITY**)
- Коэффициент пропускания света (**EXTINCTION COEFFICIENT**)
- Оптическая плотность (**OPTICAL DENSITY**)

В FDS *EXTINCTION COEFFICIENT* и *OPTICAL DENSITY* не учитывают водяной пар, который часто, хоть и в малых количествах, но всё же присутствует в составе дыма.

Параметр *VISIBILITY* - весьма перспективный параметр, воздействующий на дымовой пожарный извещатель, и выбран не случайно. Он является частью спектрально-массовой характеристики веществ (SPEC) в FDS и учитывает не только водяной пар, но и прочие химические составы (SPEC), которые пользователь добавляет в рекацию.

Расчёт критического значения по видимости для пожарного извещателя представлен в файле **Расчёт_VisL.sm**. 

Расчёт критических значений ***F*** и ***dэфф***, а также значение расстояния между извещателями ***L*** в табличном виде, представлены в файле **Расчёт dэфф_ИПДОТ.sm**.

Файлы с расширением **.sm** можно открыть с помощью [**SMath**](https://www.smath.com/ru-RU/).

Таким образом *EXTINCTION COEFFICIENT* и *OPTICAL DENSITY* в FDS - это одно и то же. Разница лишь в том, что в **PCTT** для ***EXTINCTION COEFFICIENT*** в качестве единицы измерения используется **дБ/м**, а для ***OPTICAL DENSITY*** используется **Нп/м**, а также соответствующие критические значения: **0.2 дБ/м** и **0.023 Нп/м** соответстенно, согласно [**приложению 11 Методики 1140**](https://ivo.garant.ru/#/document/406577165/paragraph/1532/doclist/6480/1/0/0/%D0%BC%D0%B5%D1%82%D0%BE%D0%B4%D0%B8%D0%BA%D0%B0%201140:0).

Например, Феникс и FireRisk (от Карькина) используют параметр Extinction Coefficient (коэффициент светопропускания).

По окончании моделирования пожара, программа вычисляет, в какой момент времени площадь области ***F*** достигла такого значения, что её эффективный диаметр (***dэфф***) стал больше нормативного расстояния между извещателями (***L***). Этот момент времени и есть ***tпор***.

![firegoaway_pctt_demo_gif-min](https://github.com/firegoaway/Plot_CSV_Time_Threshhold/blob/main/.gitpics/pctt_demo_gif-min.gif)

### Поддерживаемые версии FDS
> [**FDS 6.9.1**](https://github.com/firemodels/fds/releases/tag/FDS-6.9.1)
> [**FDS 6.9.0**](https://github.com/firemodels/fds/releases/tag/FDS-6.9.0)
> [**FDS 6.8.0**](https://github.com/firemodels/fds/releases/tag/FDS-6.8.0)

## Как установить и пользоваться
> **PCTT** работает как самостоятельно, так и в связке с утилитой [**Zmejka**](https://github.com/firegoaway/Zmejka)

|	№ п/п	|	Действие	|
|---------|---------|
|	1	|	Скачайте последнюю версию **Zmejka** в разделе [**Releases**](https://github.com/firegoaway/Zmejka/releases)	|
|	2	|	Запустите **Zmejka.exe**. Нажмите **"Browse .fds"** и выберите файл сценария FDS	|
|	3	|	Во вкладке **"Settings"** нажмите **"Run Insert_DEVC"**. Откроется новое окно	|
|	4	|	В окне **Insert_DEVC** выберите параметр, воздействующий на пожарный извещатель и введите высоту помещения. Нажмите **OK**. Важно помнить, что высоту помещенения нужно указать абсолютную. То есть, если помещение имеет высоту 3 м, но находится на 2 этаже, то в поле ***Hпом =*** нужно вписать **6**. Если помещение имеет высоту 3 м, но находится на 10 этаже, то ***Hпом = 30***. Помните также, что программа воспринимает дробные числа только с **точкой (.)** в качестве десятичного разделителя, то есть число **3,5** нужно вводить как **3.5**	|
|	5	|	В окне **Zmejka** вернитесь во вкладку **"General"**. Вновь нажмите **"Browse .fds"** и выберите файл сценария FDS с постфиксом **_tout**. Его программа создаёт рядом с оригинальным файлом сценария	|
|	6	|	Запустите моделирование пожара, нажав **"Start"**. После завершения моделирования в папке с указанным файлом сценария FDS будет находиться файл формата CSV **scenario_name_tout_devc.csv**	|
|	7	|	Перейдите во вкладку **"Settings"** и нажмите на кнопку **"Run PCTT"**. Откроется новое окно. Если **PCTT** запущена через **Zmejka**, то все нужные параметры в полях подставляются автоматически 	|
|	8	|	Нажмите на кнопку **"Browse CSV"**. Выберите файл формата CSV **scenario_name_tout_devc.csv**. Нажмите **"Draw"**	|
|	9	|	Немного подождите, пока утилита анализирует данные, содержащиеся в файле. Время анализа зависит от объёма данных. После окончания анализа откроется окно с отрисованным графиком и пользовательским интерфейсом. Вы сможете отмасштабировать график как вам нужно и сохранить в формате **.png**	|

## Статус разработки
> **Альфа**

## Профилактика вирусов и угроз
- Утилита **"PCTT"** предоставляется **"как есть"**.
- Актуальная версия утилиты доступна в разделе [**Releases**](https://github.com/firegoaway/Plot_CSV_Time_Threshhold/releases), однако использовать утилиту в отрыве от [**Zmejka**](https://github.com/firegoaway/Zmejka) не рекомендуется.
- Файлы, каким-либо образом полученные не из текущего репозитория, несут потенциальную угрозу вашему ПК.
- Файл с расширением **.exe**, полученный из данного репозитория, имеет уникальную Хэш-сумму, позволяющую отличить оригинальную утилиту от подделки.
- Хэш-сумма обновляется только при обновлении версии утилиты и всегда доступна в конце файла **README.md**.

### Актуальная Хэш-сумма
> PCTT.exe - **b41b14a711e8cec57f86b6988c4c62fa**

> Insert_DEVC.exe - **26a14c5b86678dc79233303dac3e685d**